# YOLO v2 #

YOLO v2는 기존 YOLO 알고리즘의 두 번째 버전으로, 정확도를 높인 모델이며 YOLO v2 모델을 기반으로 무려 9000종류의 물체를 구분할 수 있는 YOLO 9000 모델을 공개하였다.

-> 이전까지 Object Detection 분야에서 가장 많이 사용되었던 데이터 셋인 coco가 약 80종류의 클래스를 가진 것과 비교하면 파격적

저자들은 해당 논문을 크게 **Better, Faster, Stronger**으로 나누었다.

# 1. Better #

Better 챕터에서 저자는 기존 YOLO 모델의 한계점으로 지적되었던 **정확도**를 어떻게 개선하였는지를 설명한다(어떤 방법들을 이용하여 recall과 localization성능을 높였는지)

**<성능 향상 요인>**

1) Batch normalization - 모든 컨볼루션 레이어에 배치 정규화를 추가

2) High Resolution Classifier - 높은 해상도 이미지로 backbone CNN 네트워크 fine tune

3) Anchor box - 경계 박스를 처음부터 직접 예측 -> 앵커 박스를 초기값으로 사용하여 예측

    3-1) Convolutional With Anchor Boxes - 기존 yolo에서 Fully Connected Layer를 떼어내고 Fully Convolutional Network 형태로 prediction을 계산

    3-2) Dimension Cluster - 실제 경계 박스들을 클러스터링하여 최적의 앵커박스를 찾음

    3-3) Direct Location Prediction - 경계 박스가 그리드 셀에서 벗어나지 않게 제약을 둠

4) Fine-Grained Features - 최종 feature map의 크기를 7x7에서 13x13으로 키움

5) Multi-Scale Training - 학습데이터의 크기를 320x320, 352x352, ..., 608x608 로 resize 하면서 다양한 스케일로 학습

## 1) Batch Normalization ##

YOLO v1에서 사용되고 있는 convolution layer에 모두 batch normalization을 적용시켜 mAP 2% 성능향상을 기록했다.

***batch normalization이란?***

![image](https://user-images.githubusercontent.com/66320010/107905330-b9053780-6f91-11eb-9454-3b39703ba86b.png)

*배치 정규화는 활성화함수의 활성화값 또는 출력값을 정규화(정규분포로 만든다)하는 작업을 말한다. 신경망의 각 layer에서 데이터(배치)의 분포를 정규화하는 작업이다. 일종의 노이즈를 추가하는 방법으로 (bias와 유사) 이는 배치마다 정규화를 함으로써 전체 데이터에 대한 평균의 분산과 값이 달라질 수 있다. 학습을 할 때마다 활성화값/출력값을 정규화하기 때문에 초기화(가중치 초깃값) 문제에서 비교적 자유로워진다.*

## 2) High Resolution Classifier ##

YOLO v1에서 feature extraction목적으로 사용된 CNN모델은 VGG 16기반이다.

VGG 16은 224 x 224 이미지로 resize되어 학습하기 때문에 224 x 224 이미지에 대한 객체를 classification하는데 최적화 되어있다.

그런데 YOLO v1을 보면 input 이미지 사이즈가 2배 더 커진 것을 확인할 수 있다. 따라서 448 x 448 이미지에 익숙하지 않은 VGG 16 기반의 CNN모델은 detection에서 성능저하를 일으킨다.

-> 따라서 YOLO v2에서는 imageNet의 데이터셋에서 448 x 448 이미지들을 다시 학습시켜 fine tuning해주었다.
 
 




